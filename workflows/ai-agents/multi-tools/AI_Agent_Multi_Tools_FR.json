{
  "id": "ai-agent-multi-tools-2024",
  "meta": {
    "instanceId": "n8n-workflow-template-ai-agent-multi-tools"
  },
  "name": "ü§ñ Agent IA Multi-Outils avec M√©moire",
  "tags": ["ai-agent", "openai", "tools", "memory", "chat"],
  "nodes": [
    {
      "id": "chat-trigger-001",
      "name": "R√©ception Message Chat",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "position": [-280, 300],
      "webhookId": "ai-agent-chat-trigger-001",
      "parameters": {
        "public": true,
        "initialMessages": "=Bonjour ! Je suis votre assistant IA multi-outils. Je peux vous aider avec :\n\nüïê **Heure et Date** - Obtenir l'heure actuelle dans diff√©rents fuseaux horaires\nüî¢ **Calculs** - Effectuer des op√©rations math√©matiques\nüåê **Recherche Web** - Rechercher des informations sur internet\nüìù **R√©sum√©s** - R√©sumer du texte ou des documents\n\nComment puis-je vous aider aujourd'hui ?",
        "options": {
          "title": "Assistant IA Multi-Outils",
          "subtitle": "Propuls√© par n8n et OpenAI",
          "inputPlaceholder": "Tapez votre message ici...",
          "loadPreviousSession": "memory"
        }
      },
      "typeVersion": 1.1
    },
    {
      "id": "ai-agent-001",
      "name": "Agent IA Principal",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [300, 300],
      "parameters": {
        "text": "={{ $json.chatInput }}",
        "options": {
          "systemMessage": "=Tu es un assistant IA polyvalent et serviable, con√ßu pour aider les utilisateurs avec diverses t√¢ches.\n\nDate et heure actuelles: {{ DateTime.local().toFormat('cccc d LLLL yyyy HH:mm:ss') }}\n\n## Tes Capacit√©s:\n1. **Outil Heure/Date**: Obtenir l'heure actuelle dans diff√©rents fuseaux horaires\n2. **Outil Calculatrice**: Effectuer des calculs math√©matiques complexes\n3. **Outil Code**: Ex√©cuter du code JavaScript pour des t√¢ches avanc√©es\n4. **Outil HTTP**: Faire des requ√™tes vers des APIs externes\n\n## Directives de Comportement:\n- R√©ponds TOUJOURS dans la langue de l'utilisateur (fran√ßais si le message est en fran√ßais)\n- Sois concis mais complet dans tes r√©ponses\n- Utilise les outils appropri√©s quand c'est n√©cessaire\n- Si tu n'es pas s√ªr, demande des clarifications\n- Formate tes r√©ponses de mani√®re claire avec des emojis pertinents\n\n## Gestion des Erreurs:\n- Si un outil √©choue, explique le probl√®me √† l'utilisateur\n- Propose des alternatives quand c'est possible\n- Ne jamais inventer des donn√©es - utilise les outils pour obtenir des informations r√©elles\n\n## Format de R√©ponse:\n- Utilise des listes √† puces pour les informations multiples\n- Mets en gras les informations importantes\n- Ajoute des s√©parateurs visuels pour la lisibilit√©",
          "maxIterations": 10,
          "returnIntermediateSteps": false
        },
        "promptType": "define"
      },
      "typeVersion": 1.7
    },
    {
      "id": "openai-model-001",
      "name": "Mod√®le OpenAI GPT-4o",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [100, 520],
      "parameters": {
        "model": "gpt-4o",
        "options": {
          "temperature": 0.7,
          "maxTokens": 4096,
          "timeout": 60000
        }
      },
      "credentials": {
        "openAiApi": {
          "id": "votre-credential-id",
          "name": "OpenAI API"
        }
      },
      "typeVersion": 1.1
    },
    {
      "id": "memory-buffer-001",
      "name": "M√©moire Conversation",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "position": [300, 520],
      "parameters": {
        "sessionKey": "={{ $('R√©ception Message Chat').item.json.sessionId }}",
        "sessionIdType": "customKey",
        "contextWindowLength": 20
      },
      "typeVersion": 1.3
    },
    {
      "id": "tool-datetime-001",
      "name": "Outil Heure et Date",
      "type": "@n8n/n8n-nodes-langchain.toolCode",
      "position": [500, 520],
      "parameters": {
        "name": "get_current_datetime",
        "description": "Obtient la date et l'heure actuelles. Peut aussi convertir vers diff√©rents fuseaux horaires si sp√©cifi√©. Param√®tres: timezone (optionnel) - ex: 'Europe/Paris', 'America/New_York', 'Asia/Tokyo'",
        "jsCode": "try {\n  const timezone = $input?.timezone || 'Europe/Paris';\n  const now = new Date();\n  \n  const options = {\n    timeZone: timezone,\n    weekday: 'long',\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit',\n    second: '2-digit',\n    hour12: false\n  };\n  \n  const formattedDate = now.toLocaleDateString('fr-FR', options);\n  const formattedTime = now.toLocaleTimeString('fr-FR', { timeZone: timezone, hour12: false });\n  \n  return {\n    timezone: timezone,\n    date_complete: formattedDate,\n    heure: formattedTime,\n    timestamp_unix: Math.floor(now.getTime() / 1000),\n    iso_8601: now.toISOString(),\n    jour_semaine: now.toLocaleDateString('fr-FR', { timeZone: timezone, weekday: 'long' }),\n    jour: now.toLocaleDateString('fr-FR', { timeZone: timezone, day: 'numeric' }),\n    mois: now.toLocaleDateString('fr-FR', { timeZone: timezone, month: 'long' }),\n    annee: now.toLocaleDateString('fr-FR', { timeZone: timezone, year: 'numeric' })\n  };\n} catch (error) {\n  return {\n    erreur: true,\n    message: `Erreur lors de l'obtention de l'heure: ${error.message}`,\n    timezone_demande: $input?.timezone || 'non sp√©cifi√©'\n  };\n}"
      },
      "typeVersion": 1.1
    },
    {
      "id": "tool-calculator-001",
      "name": "Outil Calculatrice",
      "type": "@n8n/n8n-nodes-langchain.toolCode",
      "position": [700, 520],
      "parameters": {
        "name": "calculator",
        "description": "Effectue des calculs math√©matiques. Supporte: addition, soustraction, multiplication, division, puissance, racine carr√©e, pourcentage, et fonctions trigonom√©triques.",
        "jsCode": "try {\n  let expression = $input?.expression || '';\n  if (!expression) { return { erreur: true, message: 'Aucune expression fournie' }; }\n  expression = expression.replace(/sqrt\\(/g, 'Math.sqrt(').replace(/pow\\(/g, 'Math.pow(').replace(/sin\\(/g, 'Math.sin(').replace(/cos\\(/g, 'Math.cos(').replace(/tan\\(/g, 'Math.tan(').replace(/log\\(/g, 'Math.log10(').replace(/ln\\(/g, 'Math.log(').replace(/abs\\(/g, 'Math.abs(').replace(/floor\\(/g, 'Math.floor(').replace(/ceil\\(/g, 'Math.ceil(').replace(/round\\(/g, 'Math.round(').replace(/pi/gi, 'Math.PI').replace(/\\^/g, '**');\n  const resultat = eval(expression);\n  return { expression_originale: $input.expression, resultat: resultat, resultat_arrondi: Math.round(resultat * 1000000) / 1000000 };\n} catch (error) { return { erreur: true, message: `Erreur de calcul: ${error.message}` }; }"
      },
      "typeVersion": 1.1
    },
    {
      "id": "tool-http-001",
      "name": "Outil Requ√™te HTTP",
      "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
      "position": [900, 520],
      "parameters": {
        "method": "GET",
        "url": "={{ $fromAI('url', 'URL de l\\'API √† appeler') }}",
        "descriptionType": "manual",
        "toolDescription": "Effectue des requ√™tes HTTP vers des APIs externes.",
        "options": { "timeout": 30000 }
      },
      "typeVersion": 1.1
    },
    {
      "id": "tool-text-analyzer-001",
      "name": "Outil Analyse Texte",
      "type": "@n8n/n8n-nodes-langchain.toolCode",
      "position": [700, 700],
      "parameters": {
        "name": "text_analyzer",
        "description": "Analyse un texte et retourne des statistiques.",
        "jsCode": "try {\n  const text = $input?.text || '';\n  if (!text) { return { erreur: true, message: 'Aucun texte fourni' }; }\n  const mots = text.trim().split(/\\s+/).filter(m => m.length > 0);\n  const phrases = text.split(/[.!?]+/).filter(p => p.trim().length > 0);\n  return { nombre_mots: mots.length, nombre_caracteres: text.length, nombre_phrases: phrases.length, temps_lecture_minutes: Math.ceil(mots.length / 200) };\n} catch (error) { return { erreur: true, message: error.message }; }"
      },
      "typeVersion": 1.1
    },
    {
      "id": "format-response-001",
      "name": "Formater R√©ponse",
      "type": "n8n-nodes-base.set",
      "position": [580, 300],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            { "id": "output", "name": "output", "type": "string", "value": "={{ $json.output }}" },
            { "id": "sessionId", "name": "sessionId", "type": "string", "value": "={{ $('R√©ception Message Chat').item.json.sessionId }}" }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "sticky-note-intro",
      "name": "Note - Introduction",
      "type": "n8n-nodes-base.stickyNote",
      "position": [-500, 100],
      "parameters": {
        "color": 7,
        "width": 400,
        "height": 400,
        "content": "# ü§ñ Agent IA Multi-Outils\n\n## Description\nCe workflow impl√©mente un agent IA conversationnel avec plusieurs outils.\n\n## Outils Disponibles\n1. Heure/Date - Fuseaux horaires\n2. Calculatrice - Op√©rations math√©matiques\n3. Requ√™tes HTTP - APIs externes\n4. Analyse de texte - Statistiques\n\n## Configuration\n- Cl√© API OpenAI requise\n- n8n version 1.0+"
      },
      "typeVersion": 1
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "timezone": "Europe/Paris",
    "executionOrder": "v1"
  },
  "connections": {
    "R√©ception Message Chat": { "main": [[{ "node": "Agent IA Principal", "type": "main", "index": 0 }]] },
    "Agent IA Principal": { "main": [[{ "node": "Formater R√©ponse", "type": "main", "index": 0 }]] },
    "Mod√®le OpenAI GPT-4o": { "ai_languageModel": [[{ "node": "Agent IA Principal", "type": "ai_languageModel", "index": 0 }]] },
    "M√©moire Conversation": { "ai_memory": [[{ "node": "Agent IA Principal", "type": "ai_memory", "index": 0 }]] },
    "Outil Heure et Date": { "ai_tool": [[{ "node": "Agent IA Principal", "type": "ai_tool", "index": 0 }]] },
    "Outil Calculatrice": { "ai_tool": [[{ "node": "Agent IA Principal", "type": "ai_tool", "index": 0 }]] },
    "Outil Requ√™te HTTP": { "ai_tool": [[{ "node": "Agent IA Principal", "type": "ai_tool", "index": 0 }]] },
    "Outil Analyse Texte": { "ai_tool": [[{ "node": "Agent IA Principal", "type": "ai_tool", "index": 0 }]] }
  }
}